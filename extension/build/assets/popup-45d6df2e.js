import"./modulepreload-polyfill-3cfb730f.js";const d=o=>{if(!o)return!1;try{const e=new URL(o);return e.pathname.split("/").filter(a=>a).length>=2&&e.hostname==="github.com"}catch{return!1}},l=async()=>{try{const[o]=await chrome.tabs.query({active:!0,currentWindow:!0}),e=document.getElementById("open-dashboard"),t=document.getElementById("dashboard-hint");if(!e||!t)return;d(o.url)?(e.disabled=!1,e.style.background="#238636",e.style.cursor="pointer",t.textContent="Dashboard will appear inline on the page"):(e.disabled=!0,e.style.background="#bbb",e.style.cursor="not-allowed",t.textContent="Go to a GitHub repository page")}catch(o){console.error("Error updating dashboard button state:",o)}};document.addEventListener("DOMContentLoaded",()=>{l();const o=document.getElementById("github-token"),e=document.getElementById("save-token"),t=document.getElementById("token-status"),a=document.getElementById("open-dashboard");chrome.storage.local.get(["githubToken"],n=>{n.githubToken&&(o.value=n.githubToken,t.textContent="Token loaded",t.style.color="green")}),e.addEventListener("click",()=>{const n=o.value.trim();n.length>0?chrome.storage.local.set({githubToken:n},()=>{t.textContent="Token saved",t.style.color="green"}):chrome.storage.local.remove(["githubToken"],()=>{t.textContent="Token deleted",t.style.color="orange"})}),a.addEventListener("click",async()=>{if(!a.disabled){const[n]=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.tabs.sendMessage(n.id,{action:"openDashboardPage"},i=>{if(chrome.runtime.lastError){console.log("Content script not ready, opening in new tab as fallback");const r=chrome.runtime.getURL("react_page/index.html"),s=chrome.runtime.getURL("dashboard.html");fetch(r,{method:"HEAD"}).then(c=>{c.ok?chrome.tabs.create({url:r}):chrome.tabs.create({url:s})}).catch(()=>chrome.tabs.create({url:s}))}else window.close()})}})});
